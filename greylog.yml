- hosts: Greylog
  become: True
  vars:
    #Elasticsearch vars
    es_major_version: "7.x"
    es_version: "7.10.2"
    es_enable_xpack: False
    es_instance_name: "graylog"
    es_heap_size: "1g"
    es_config:
      node.name: "graylog"
      cluster.name: "graylog"
      http.port: 9200
      transport.tcp.port: 9300
      network.host: "127.0.0.1"
      discovery.seed_hosts: "localhost:9300"
      cluster.initial_master_nodes: "graylog"
    oss_version: True
    es_action_auto_create_index: False

    #Graylog vars
    graylog_version: 4.2
    graylog_install_java: True
    graylog_password_secret: !vault | 
      $ANSIBLE_VAULT;1.1;AES256
      34336339643865636362633737346161303562363631626335613838373135646266326461643666
      3366343536333139303035333232303135363435306331630a373832316235313562396334363664
      35663433306639653563333231663238366531353334343032646535616236623535326561336164
      6161343337333539360a313034623932363238656532376362343161326663336162663437376234
      61386361333163383133666332643330346665346163383832633762316263626231313365623737
      38626463623134373634646362383933653239383032396165306434626231356334636565386230
      61636139623338623738353634396337326133636361326338303861393232373664313361613261
      66386434643664303162626262373162363533343731613665663631333563346264356634653462
      33383832663166616333356530626565323461653064616365356530376237383062
    graylog_root_password_sha2: !vault |
      $ANSIBLE_VAULT;1.1;AES256
      32636436306562343837346632623435366263303235653362623639373031613061613264333733
      3930343561336231336162636136353066396563346533340a333866303534316533623632343964
      35373465306139643536643735366637323635366238343261616533373865636162346233306562
      6264666239666262660a303462373433393864353235316339626431323834333334333461346531
      66633438373532383936666662356237366335386532316561636434306137336166613938303565
      36346232613635316365313466386232323038343363366536306630303238653139366534373730
      31643430633131346234353736376635373335323334346432373463613039343638376437363261
      39373665373339316162
    graylog_http_bind_address: "{{ ansible_default_ipv4.address }}:9000"
    graylog_http_publish_uri: "http://{{ ansible_default_ipv4.address }}:9000/"
    graylog_http_external_uri: "http://{{ ansible_default_ipv4.address }}:9000/"

  roles:
    - role: "graylog2.graylog"
      tags:
        - "graylog"